<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>Bulldog Realm</title>
<style>
/* === RESET === */
*, *::before, *::after {
    margin: 0; padding: 0; box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
    user-select: none;
}
body {
    background: #060608;
    min-height: 100vh;
    display: flex; align-items: center; justify-content: center;
    overflow: hidden; color: #fff;
    font-family: 'Segoe UI', system-ui, sans-serif;
}

/* === APP SHELL === */
#app {
    position: relative;
    width: min(390px, 100vw);
    height: min(844px, 100dvh);
    /* Schiebt den Inhalt √ºber Browser-Chrome nach oben */
    padding-bottom: env(safe-area-inset-bottom, 0px);
    overflow: hidden;
    background: #0d0d1a;
    border-radius: clamp(0px, calc((100vw - 390px) * 99), 24px);
    box-shadow: 0 0 0 1px rgba(255,255,255,0.07), 0 30px 80px rgba(0,0,0,0.9);
}

/* === SCREENS === */
.screen {
    display: none;
    position: absolute; inset: 0; overflow: hidden;
}
.screen.active { display: block; }
#screen-battle.active { display: flex; flex-direction: column; }

/* === BACKGROUND === */
.bg {
    position: absolute; inset: 0;
    background-size: cover; background-position: center;
    z-index: 0;
}
.bg-dim {
    position: absolute; inset: 0;
    background: linear-gradient(180deg, rgba(5,4,12,0.3) 0%, rgba(5,4,12,0.5) 55%, rgba(5,4,12,0.82) 100%);
    z-index: 1;
}

/* ==========================================
   TOP HUD
   ========================================== */
.top-hud {
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 120px;
    z-index: 50;
}
/* Das Overlay-Bild als Hintergrund ‚Äî kein <img> Tag, kein Overflow-Problem */
.top-hud-bg {
    position: absolute; inset: 0;
    background-image: url('https://raw.githubusercontent.com/emfau88/bulldog-realm/refs/heads/main/top.png');
    background-size: 100% 100%;
    background-repeat: no-repeat;
    pointer-events: none;
}
.top-hud-content {
    position: absolute; inset: 0;
    display: flex; align-items: center;
    padding: 0 138px 0 8px; /* rechts Platz f√ºr Nav-Icons */
    gap: 10px;
}
.top-avatar {
    width: 72px; height: 72px;
    border-radius: 50%; overflow: hidden;
    flex: 0 0 72px;
}
.top-avatar img { width: 100%; height: 100%; object-fit: cover; }
.top-info {
    flex: 1; min-width: 0;
}
.top-name {
    font-size: 15px; font-weight: 800;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    text-shadow: 0 1px 6px rgba(0,0,0,0.9);
}
.top-lvl {
    font-size: 11px; color: #f5c84c; font-weight: 600;
    text-shadow: 0 1px 4px rgba(0,0,0,0.9); margin-top: 2px;
}

/* === NAV ICONS ‚Äî absolut positioniert, pixelgenau auf Asset-Kreise === */
.top-nav {
    position: absolute;
    top: 0; right: 0; bottom: 0;
    width: 160px;
    pointer-events: none;
}
.top-nav-btn {
    position: absolute;
    width: 36px; height: 36px;
    top: 50%; transform: translateY(-50%);
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 19px; line-height: 1;
    cursor: pointer; background: transparent;
    border: none; color: white;
    pointer-events: auto;
    transition: opacity 0.15s;
}
.top-nav-btn:active { opacity: 0.6; }
/* Positionen von rechts gemessen ‚Äî Kreise im Asset bei ~85px, ~50px, ~12px von rechts */
.top-nav-btn:nth-child(1) { right: 85px; } /* üè† */
.top-nav-btn:nth-child(2) { right: 48px; } /* üèãÔ∏è */
.top-nav-btn:nth-child(3) { right: 10px; } /* üíÄ */

/* ==========================================
   BOTTOM HUD
   ========================================== */
.bot-hud {
    position: absolute;
    bottom: 0; left: 0; right: 0;
    /* Hoch genug f√ºr Browser-Chrome + eigentlichen HUD-Inhalt */
    height: 160px;
    z-index: 50;
}
.bot-hud-bg {
    position: absolute;
    bottom: 0; left: 0; right: 0;
    height: 100px; /* echte Asset-H√∂he */
    background-image: url('https://raw.githubusercontent.com/emfau88/bulldog-realm/refs/heads/main/bottom.png');
    background-size: 100% 100%;
    background-repeat: no-repeat;
    pointer-events: none;
}
.bot-hud-content {
    position: absolute;
    bottom: 0; left: 0; right: 0;
    height: 100px; /* Buttons im Asset-Bereich zentrieren */
    display: flex; align-items: center; justify-content: space-around;
    padding: 0 16px;
}
.action-btn {
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    gap: 3px; width: 90px; height: 72px;
    background: transparent; border: none; color: #fff;
    cursor: pointer; transition: transform 0.15s;
    position: relative; overflow: hidden;
}
.action-btn:active { transform: scale(0.9); }
.action-btn:disabled { opacity: 0.45; }
.action-icon { font-size: 24px; line-height: 1; }
.action-label { font-size: 12px; font-weight: 700; }
.cd-overlay {
    position: absolute; inset: 0;
    background: rgba(0,0,0,0.7);
    display: none; flex-direction: column;
    align-items: center; justify-content: center;
    font-size: 13px; font-weight: 800; border-radius: 8px;
}
.action-btn.on-cd .cd-overlay { display: flex; }
.cd-bar {
    position: absolute; left: 0; top: 0; bottom: 0;
    background: rgba(255,255,255,0.06); width: 0%;
}

/* ==========================================
   STAT BARS
   ========================================== */
.stat-bars {
    position: absolute;
    top: 126px; left: 10px; right: 10px;
    z-index: 20; display: flex; flex-direction: column; gap: 5px;
}
.bar-row {
    display: flex; align-items: center; gap: 8px;
    background: rgba(0,0,0,0.68); backdrop-filter: blur(6px);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 10px; padding: 5px 10px;
}
.bar-ico { font-size: 16px; flex: 0 0 26px; text-align: center; }
.bar-track {
    flex: 1; height: 9px; border-radius: 999px;
    background: rgba(255,255,255,0.10); overflow: hidden;
}
.bar-fill {
    height: 100%; border-radius: 999px; transition: width 0.4s;
    background: linear-gradient(90deg, rgba(245,200,76,0.5), #f5c84c);
}
.bar-fill.red  { background: linear-gradient(90deg, rgba(255,77,109,0.5), #ff4d6d); }
.bar-fill.blue { background: linear-gradient(90deg, rgba(55,150,255,0.5), #3796ff); }
.bar-txt { width: 36px; text-align: right; font-size: 10px; font-weight: 700; opacity: 0.85; }

/* ==========================================
   HERO
   ========================================== */
.hero-area {
    position: absolute;
    top: 270px; bottom: 165px;
    left: 0; right: 0;
    display: flex; align-items: center; justify-content: center;
    pointer-events: none; z-index: 10;
}
.hero-area img {
    max-height: 100%; max-width: 78%; object-fit: contain;
    filter: drop-shadow(0 16px 28px rgba(0,0,0,0.8));
    animation: idle 3s ease-in-out infinite;
}
@keyframes idle {
    0%,100% { transform: translateY(0) scale(1); }
    50%      { transform: translateY(-8px) scale(1.02); }
}

/* ==========================================
   CHARACTER SELECT
   ========================================== */
#screen-select {
    background: linear-gradient(180deg, #0d0a1a, #1a0d0a);
    display: flex; flex-direction: column;
}
.char-header {
    padding: 22px 16px 10px; text-align: center;
}
.char-title {
    font-size: 20px; font-weight: 900;
    background: linear-gradient(90deg, #ffd700, #ffaa00);
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
}
.char-scroll {
    flex: 1; display: flex; overflow-x: auto; gap: 12px;
    padding: 8px 16px 20px; scroll-snap-type: x mandatory; scrollbar-width: none;
}
.char-scroll::-webkit-scrollbar { display: none; }
.char-card {
    flex: 0 0 calc(100% - 32px);
    background: linear-gradient(145deg, #1e1e40, #151530);
    border-radius: 20px; padding: 18px; scroll-snap-align: center;
    border: 2px solid rgba(255,255,255,0.08);
    display: flex; flex-direction: column; align-items: center; gap: 10px;
}
.char-card.selected { border-color: #00ff88; }
.char-frame {
    width: 130px; height: 165px;
    background-image: url('https://raw.githubusercontent.com/emfau88/bulldog-realm/refs/heads/main/file_00000000a8b8720abd5966125bc21f74.png');
    background-size: contain; background-repeat: no-repeat; background-position: center;
    display: flex; align-items: center; justify-content: center;
}
.char-img { width: 88px; height: 88px; object-fit: contain; }
.char-name { font-size: 20px; font-weight: 700; }
.char-desc { font-size: 12px; color: #9090a8; text-align: center; line-height: 1.4; }
.char-stats {
    display: flex; justify-content: space-around; width: 100%;
    background: rgba(0,0,0,0.35); padding: 10px; border-radius: 10px;
}
.char-stat { text-align: center; }
.char-stat-ico { font-size: 16px; }
.char-stat-val { font-size: 15px; font-weight: 700; color: #ffd700; }
.char-stat-lbl { font-size: 9px; color: #555; text-transform: uppercase; letter-spacing: 1px; }
.select-btn {
    width: 100%; padding: 13px; border-radius: 13px; border: none;
    background: linear-gradient(90deg, #667eea, #764ba2);
    color: white; font-size: 14px; font-weight: 800; cursor: pointer;
}
.select-btn:active { transform: scale(0.97); }

/* ==========================================
   TRAINING SCREEN
   ========================================== */
.train-body {
    position: absolute;
    top: 125px; bottom: 0; left: 0; right: 0;
    overflow-y: auto; scrollbar-width: none; z-index: 10;
    padding-bottom: 20px;
}
.train-body::-webkit-scrollbar { display: none; }
.train-hero {
    display: flex; flex-direction: column; align-items: center;
    padding: 12px 16px 0;
}
.train-hero-img {
    width: 120px; height: 120px; object-fit: contain;
    filter: drop-shadow(0 8px 20px rgba(0,0,0,0.8));
    animation: idle 3s ease-in-out infinite;
}
.train-hero-name { font-size: 22px; font-weight: 900; margin-top: 8px; }
.train-xp-row {
    display: flex; align-items: center; gap: 10px;
    background: rgba(0,0,0,0.65); border: 1px solid rgba(245,200,76,0.2);
    border-radius: 10px; padding: 8px 14px; margin: 10px 14px 0;
}
.train-xp-lbl { font-size: 13px; font-weight: 800; color: #f5c84c; white-space: nowrap; }
.train-xp-track {
    flex: 1; height: 8px; border-radius: 999px;
    background: rgba(255,255,255,0.10); overflow: hidden;
}
.train-xp-fill {
    height: 100%; border-radius: 999px;
    background: linear-gradient(90deg, rgba(245,200,76,0.4), #f5c84c); transition: width 0.4s;
}
.train-xp-txt { font-size: 11px; color: rgba(255,255,255,0.7); white-space: nowrap; }
.train-energy-row {
    display: flex; align-items: center; gap: 8px;
    background: rgba(0,0,0,0.65); border: 1px solid rgba(55,150,255,0.2);
    border-radius: 10px; padding: 8px 14px; margin: 8px 14px 0;
}
.train-energy-track {
    flex: 1; height: 8px; border-radius: 999px;
    background: rgba(255,255,255,0.10); overflow: hidden;
}
.train-energy-fill {
    height: 100%; border-radius: 999px;
    background: linear-gradient(90deg, rgba(55,150,255,0.4), #3796ff); transition: width 0.4s;
}
.train-stats-grid {
    display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin: 10px 14px 0;
}
.stat-card {
    background: rgba(0,0,0,0.65); border: 1px solid rgba(255,255,255,0.09);
    border-radius: 12px; padding: 10px 12px;
    display: flex; justify-content: space-between; align-items: center;
}
.stat-card-name { font-size: 13px; font-weight: 700; }
.stat-badge {
    font-size: 10px; font-weight: 800; color: #f5c84c;
    background: rgba(245,200,76,0.15); border: 1px solid rgba(245,200,76,0.3);
    border-radius: 20px; padding: 2px 8px;
}
.train-actions { display: flex; flex-direction: column; gap: 8px; margin: 10px 14px 0; }
.train-act-card {
    background: rgba(0,0,0,0.68); border: 1px solid rgba(255,255,255,0.09);
    border-radius: 13px; padding: 12px 14px;
    display: flex; align-items: center; gap: 12px;
    cursor: pointer; transition: all 0.2s;
}
.train-act-card:active { transform: scale(0.97); }
.train-act-card.on-cd { border-color: rgba(245,200,76,0.4); }
.train-act-ico {
    width: 44px; height: 44px; border-radius: 50%;
    background: rgba(255,255,255,0.07);
    display: flex; align-items: center; justify-content: center;
    font-size: 22px; flex: 0 0 auto;
}
.train-act-info { flex: 1; }
.train-act-name { font-size: 15px; font-weight: 800; }
.train-act-sub { font-size: 11px; color: rgba(255,255,255,0.55); margin-top: 2px; }
.train-act-right { display: flex; flex-direction: column; align-items: flex-end; gap: 4px; }
.train-act-reward { font-size: 13px; font-weight: 800; color: #f5c84c; }
.train-act-cost { font-size: 10px; color: rgba(255,255,255,0.55); }
.train-act-cd { font-size: 11px; color: #70a1ff; font-weight: 700; }

/* ==========================================
   DUNGEON SCREEN
   ========================================== */
.dungeon-body {
    position: absolute;
    top: 125px; bottom: 0; left: 0; right: 0;
    overflow-y: auto; scrollbar-width: none; z-index: 10;
    padding: 0 14px 20px;
    display: flex; flex-direction: column; gap: 12px;
}
.dungeon-body::-webkit-scrollbar { display: none; }
.boss-hero { display: flex; align-items: center; justify-content: center; min-height: 220px; padding-top: 10px; }
.boss-hero img { max-height: 220px; max-width: 88%; object-fit: contain; filter: drop-shadow(0 16px 28px rgba(0,0,0,0.7)); }
.dungeon-card {
    background: rgba(0,0,0,0.68); border: 1px solid rgba(255,255,255,0.10);
    border-radius: 14px; padding: 14px;
}
.dungeon-title { font-size: 16px; font-weight: 900; color: #f5c84c; }
.dungeon-desc { font-size: 12px; opacity: 0.88; margin-top: 5px; line-height: 1.4; }
.dungeon-metas { display: flex; gap: 7px; flex-wrap: wrap; margin-top: 10px; }
.dmeta { font-size: 11px; padding: 4px 10px; border-radius: 999px; background: rgba(255,255,255,0.10); }
.dmeta.danger { background: rgba(255,77,109,0.15); border: 1px solid rgba(255,77,109,0.25); }
.dmeta.reward { background: rgba(245,200,76,0.12); border: 1px solid rgba(245,200,76,0.25); color: #f5c84c; }
.primary-btn {
    width: 100%; padding: 15px; border-radius: 13px;
    border: 1px solid rgba(245,200,76,0.4);
    background: linear-gradient(90deg, rgba(245,200,76,0.22), rgba(245,200,76,0.08));
    color: #fff; font-weight: 900; font-size: 15px; cursor: pointer; transition: all 0.2s;
}
.primary-btn:active { transform: scale(0.97); }

/* ==========================================
   BATTLE SCREEN
   ========================================== */
.battle-header {
    padding: 12px; text-align: center; font-size: 15px; font-weight: 900;
    color: #ff6b81; letter-spacing: 3px; background: rgba(0,0,0,0.85); flex: 0 0 auto;
}
.battle-arena {
    flex: 1; min-height: 0;
    background-image: url('https://raw.githubusercontent.com/emfau88/bulldog-realm/refs/heads/main/file_00000000b334720a9cdaafe101317355.png');
    background-size: cover; background-position: center;
    position: relative; display: flex; align-items: center; justify-content: space-between; padding: 14px;
}
.battle-arena::before { content: ''; position: absolute; inset: 0; background: rgba(0,0,0,0.4); }
.fighter { position: relative; z-index: 1; text-align: center; width: 42%; }
.fighter-img { width: 100%; max-width: 110px; border-radius: 12px; border: 2px solid #ffd700; background: rgba(0,0,0,0.5); }
.fighter-img.enemy { border-color: #ff4757; }
.fighter-name { margin-top: 5px; font-size: 11px; font-weight: 700; }
.hp-box { margin-top: 5px; background: rgba(0,0,0,0.8); padding: 5px; border-radius: 7px; }
.hp-bg { height: 7px; background: rgba(255,255,255,0.1); border-radius: 3px; overflow: hidden; }
.hp-fill { height: 100%; background: linear-gradient(90deg, #2ed573, #26de81); border-radius: 3px; transition: width 0.3s; }
.hp-fill.enemy { background: linear-gradient(90deg, #ff4757, #ff6348); }
.hp-txt { font-size: 10px; margin-top: 3px; font-weight: 600; }
.vs-badge {
    position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%);
    background: linear-gradient(145deg, #ffd700, #ffaa00); color: #000;
    font-weight: 900; font-size: 13px; padding: 7px 14px; border-radius: 18px; z-index: 2;
}
.battle-controls { flex: 0 0 auto; background: rgba(8,10,20,0.98); padding: 10px; border-top: 1px solid rgba(255,255,255,0.07); }
.battle-log { height: 60px; overflow-y: auto; background: rgba(255,255,255,0.04); border-radius: 7px; padding: 7px; margin-bottom: 9px; font-size: 11px; scrollbar-width: none; }
.battle-log p { margin-bottom: 3px; padding: 2px 5px; border-radius: 4px; }
.log-player { background: rgba(55,66,250,0.3); border-left: 3px solid #3742fa; }
.log-enemy  { background: rgba(255,71,87,0.3); border-left: 3px solid #ff4757; }
.log-system { background: rgba(255,215,0,0.2); text-align: center; }
.battle-btns { display: grid; grid-template-columns: repeat(4,1fr); gap: 7px; }
.battle-btn {
    background: linear-gradient(145deg, #ff4757, #c0392b); border: none;
    border-radius: 11px; padding: 11px 3px; color: white; font-size: 10px; font-weight: 700; cursor: pointer;
}
.battle-btn:active { transform: scale(0.94); }
.dmg-popup {
    position: absolute; font-weight: 900; font-size: 26px; pointer-events: none;
    animation: dmgFloat 1s ease forwards; color: #ff4757; z-index: 100;
}
@keyframes dmgFloat {
    0%   { transform: translateY(0) scale(0.5); opacity: 0; }
    20%  { transform: translateY(-18px) scale(1.3); opacity: 1; }
    100% { transform: translateY(-55px) scale(1); opacity: 0; }
}

/* ==========================================
   TOAST
   ========================================== */
.toast {
    position: absolute; top: 100px; left: 50%;
    transform: translateX(-50%) translateY(-20px);
    background: rgba(0,0,0,0.95); padding: 9px 20px; border-radius: 20px;
    font-size: 12px; font-weight: 600; z-index: 999;
    border: 1px solid rgba(255,255,255,0.1);
    opacity: 0; transition: all 0.3s; white-space: nowrap; pointer-events: none;
}
.toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }
.toast.success { border-color: #2ed573; color: #2ed573; }
.toast.error   { border-color: #ff4757; color: #ff6b81; }

@keyframes pulseFlash {
    0%,100% { filter: brightness(1); }
    50%      { filter: brightness(1.4); }
}
</style>
</head>
<body>
<div id="app">

<!-- ===== CHARACTER SELECT ===== -->
<div id="screen-select" class="screen active">
    <div class="char-header"><div class="char-title">üêï W√ÑHLE DEINEN BULLDOG</div></div>
    <div class="char-scroll">
        <div class="char-card" onclick="selectChar('demon',this)">
            <div class="char-frame"><img class="char-img" src="https://raw.githubusercontent.com/emfau88/bulldog-realm/refs/heads/main/file_0000000009e47243a9b9c69184ce0322.png" alt="Shadow"></div>
            <div class="char-name">Shadow</div>
            <div class="char-desc">Ein m√§chtiger D√§mon aus der Unterwelt. Zerst√∂rt alles mit roher Kraft.</div>
            <div class="char-stats">
                <div class="char-stat"><div class="char-stat-ico">‚öîÔ∏è</div><div class="char-stat-val">15</div><div class="char-stat-lbl">ATK</div></div>
                <div class="char-stat"><div class="char-stat-ico">üõ°Ô∏è</div><div class="char-stat-val">5</div><div class="char-stat-lbl">DEF</div></div>
                <div class="char-stat"><div class="char-stat-ico">‚ö°</div><div class="char-stat-val">10</div><div class="char-stat-lbl">SPD</div></div>
            </div>
            <button class="select-btn" onclick="event.stopPropagation();startGame('demon')">AUSW√ÑHLEN</button>
        </div>
        <div class="char-card" onclick="selectChar('angel',this)">
            <div class="char-frame"><img class="char-img" src="https://raw.githubusercontent.com/emfau88/bulldog-realm/refs/heads/main/fluffy2.png" alt="Fluffi"></div>
            <div class="char-name">Fluffi</div>
            <div class="char-desc">Ein himmlischer Engel. Blitzschnell und voller Liebe.</div>
            <div class="char-stats">
                <div class="char-stat"><div class="char-stat-ico">‚öîÔ∏è</div><div class="char-stat-val">8</div><div class="char-stat-lbl">ATK</div></div>
                <div class="char-stat"><div class="char-stat-ico">üõ°Ô∏è</div><div class="char-stat-val">7</div><div class="char-stat-lbl">DEF</div></div>
                <div class="char-stat"><div class="char-stat-ico">‚ö°</div><div class="char-stat-val">15</div><div class="char-stat-lbl">SPD</div></div>
            </div>
            <button class="select-btn" onclick="event.stopPropagation();startGame('angel')">AUSW√ÑHLEN</button>
        </div>
        <div class="char-card" onclick="selectChar('knight',this)">
            <div class="char-frame"><img class="char-img" src="https://raw.githubusercontent.com/emfau88/bulldog-realm/refs/heads/main/titan2.png" alt="Sir Barksalot"></div>
            <div class="char-name">Sir Barksalot</div>
            <div class="char-desc">Ein edler Ritter. Unersch√ºtterlich und stark wie eine Festung.</div>
            <div class="char-stats">
                <div class="char-stat"><div class="char-stat-ico">‚öîÔ∏è</div><div class="char-stat-val">10</div><div class="char-stat-lbl">ATK</div></div>
                <div class="char-stat"><div class="char-stat-ico">üõ°Ô∏è</div><div class="char-stat-val">15</div><div class="char-stat-lbl">DEF</div></div>
                <div class="char-stat"><div class="char-stat-ico">‚ö°</div><div class="char-stat-val">7</div><div class="char-stat-lbl">SPD</div></div>
            </div>
            <button class="select-btn" onclick="event.stopPropagation();startGame('knight')">AUSW√ÑHLEN</button>
        </div>
    </div>
</div>

<!-- ===== HOME SCREEN ===== -->
<div id="screen-home" class="screen">
    <div class="bg" style="background-image:url('https://raw.githubusercontent.com/emfau88/bulldog-realm/refs/heads/main/bghome.png')"></div>
    <div class="bg-dim"></div>
    <div class="stat-bars">
        <div class="bar-row">
            <div class="bar-ico">üçñ</div>
            <div class="bar-track"><div class="bar-fill" id="bar-hunger" style="width:80%"></div></div>
            <div class="bar-txt" id="txt-hunger">80%</div>
        </div>
        <div class="bar-row">
            <div class="bar-ico">üéØ</div>
            <div class="bar-track"><div class="bar-fill" id="bar-happy" style="width:60%"></div></div>
            <div class="bar-txt" id="txt-happy">60%</div>
        </div>
        <div class="bar-row">
            <div class="bar-ico">‚ö°</div>
            <div class="bar-track"><div class="bar-fill blue" id="bar-energy" style="width:100%"></div></div>
            <div class="bar-txt" id="txt-energy">100%</div>
        </div>
    </div>
    <div class="hero-area"><img id="home-pet" src="" alt="Pet"></div>
    <div class="top-hud">
        <div class="top-hud-bg"></div>
        <div class="top-hud-content">
            <div class="top-avatar"><img id="home-avatar" src="" alt=""></div>
            <div class="top-info">
                <div class="top-name" id="home-name">‚Äî</div>
                <div class="top-lvl">LVL <span id="home-lvl">1</span> ¬∑ XP <span id="home-xp">0</span>%</div>
            </div>
            <div class="top-nav">
                <div class="top-nav-btn" onclick="showScreen('home')">üè†</div>
                <div class="top-nav-btn" onclick="showScreen('training')">üèãÔ∏è</div>
                <div class="top-nav-btn" onclick="showScreen('dungeon')">üíÄ</div>
            </div>
        </div>
    </div>
    <div class="bot-hud">
        <div class="bot-hud-bg"></div>
        <div class="bot-hud-content">
            <button class="action-btn" id="btn-feed" onclick="action('feed')">
                <div class="cd-overlay"><div class="cd-bar"></div><span class="cd-txt"></span></div>
                <span class="action-icon">üçñ</span><span class="action-label">F√ºttern</span>
            </button>
            <button class="action-btn" id="btn-play" onclick="action('play')">
                <div class="cd-overlay"><div class="cd-bar"></div><span class="cd-txt"></span></div>
                <span class="action-icon">üéæ</span><span class="action-label">Spielen</span>
            </button>
            <button class="action-btn" id="btn-sleep" onclick="action('sleep')">
                <div class="cd-overlay"><div class="cd-bar"></div><span class="cd-txt"></span></div>
                <span class="action-icon">üò¥</span><span class="action-label">Schlafen</span>
            </button>
        </div>
    </div>
</div>

<!-- ===== TRAINING SCREEN ===== -->
<div id="screen-training" class="screen">
    <div class="bg" style="background-image:url('https://raw.githubusercontent.com/emfau88/bulldog-realm/refs/heads/main/bgtrain.png')"></div>
    <div class="bg-dim"></div>
    <div class="train-body">
        <div class="train-hero">
            <img class="train-hero-img" id="train-img" src="" alt="">
            <div class="train-hero-name" id="train-name">‚Äî</div>
        </div>
        <div class="train-xp-row">
            <div class="train-xp-lbl">‚ù§Ô∏è LVL <span id="train-lvl">1</span></div>
            <div class="train-xp-track"><div class="train-xp-fill" id="train-xp-bar" style="width:0%"></div></div>
            <div class="train-xp-txt">XP <span id="train-xp-cur">0</span>/<span id="train-xp-max">100</span></div>
        </div>
        <div class="train-energy-row">
            <div style="font-size:12px;font-weight:700;white-space:nowrap;">‚ö° Energie</div>
            <div class="train-energy-track"><div class="train-energy-fill" id="train-energy-bar" style="width:100%"></div></div>
            <div style="font-size:11px;color:#70a1ff;font-weight:700;white-space:nowrap;" id="train-energy-txt">100%</div>
        </div>
        <div class="train-stats-grid">
            <div class="stat-card"><div class="stat-card-name">‚öîÔ∏è ATK</div><div class="stat-badge">Lv <span id="stat-atk">10</span></div></div>
            <div class="stat-card"><div class="stat-card-name">üí• CRIT</div><div class="stat-badge" style="opacity:0.4;">üîí Lv5</div></div>
            <div class="stat-card"><div class="stat-card-name">‚ù§Ô∏è HP</div><div class="stat-badge">Lv <span id="stat-hp">1</span></div></div>
            <div class="stat-card"><div class="stat-card-name">üõ°Ô∏è DEF</div><div class="stat-badge">Lv <span id="stat-def">10</span></div></div>
        </div>
        <div class="train-actions">
            <div class="train-act-card" id="tcard-atk" onclick="trainAction('atk')">
                <div class="train-act-ico">‚öîÔ∏è</div>
                <div class="train-act-info">
                    <div class="train-act-name">Attacke</div>
                    <div class="train-act-sub">+1 ATK ¬∑ 25 Energie</div>
                </div>
                <div class="train-act-right">
                    <div class="train-act-reward">+1 ATK</div>
                    <div class="train-act-cd" id="cd-atk"></div>
                </div>
            </div>
            <div class="train-act-card" id="tcard-fit" onclick="trainAction('fit')">
                <div class="train-act-ico">üèãÔ∏è</div>
                <div class="train-act-info">
                    <div class="train-act-name">Fitness</div>
                    <div class="train-act-sub">+10 HP ¬∑ 20 Energie</div>
                </div>
                <div class="train-act-right">
                    <div class="train-act-reward">+10 HP</div>
                    <div class="train-act-cd" id="cd-fit"></div>
                </div>
            </div>
            <div class="train-act-card" id="tcard-def" onclick="trainAction('def')">
                <div class="train-act-ico">üõ°Ô∏è</div>
                <div class="train-act-info">
                    <div class="train-act-name">Abwehr</div>
                    <div class="train-act-sub">+1 DEF ¬∑ 20 Energie</div>
                </div>
                <div class="train-act-right">
                    <div class="train-act-reward">+1 DEF</div>
                    <div class="train-act-cd" id="cd-def"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="top-hud">
        <div class="top-hud-bg"></div>
        <div class="top-hud-content">
            <div class="top-avatar"><img id="train-avatar" src="" alt=""></div>
            <div class="top-info">
                <div class="top-name">Training</div>
                <div class="top-lvl">LVL <span id="train-lvl-hud">1</span> ¬∑ XP <span id="train-xp-pct">0</span>%</div>
            </div>
            <div class="top-nav">
                <div class="top-nav-btn" onclick="showScreen('home')">üè†</div>
                <div class="top-nav-btn" onclick="showScreen('training')">üèãÔ∏è</div>
                <div class="top-nav-btn" onclick="showScreen('dungeon')">üíÄ</div>
            </div>
        </div>
    </div>
</div>

<!-- ===== DUNGEON SCREEN ===== -->
<div id="screen-dungeon" class="screen">
    <div class="bg" style="background-image:url('https://raw.githubusercontent.com/emfau88/bulldog-realm/refs/heads/main/bgdungeon.png')"></div>
    <div class="bg-dim"></div>
    <div class="dungeon-body">
        <div class="boss-hero"><img src="https://raw.githubusercontent.com/emfau88/bulldog-realm/refs/heads/main/bosspre.png" alt="Boss"></div>
        <div class="dungeon-card">
            <div class="dungeon-title">üî• H√∂llenfestung</div>
            <div class="dungeon-desc">Betritt die H√∂llenfestung und stell dich dem D√§monen-Bulldog.</div>
            <div class="dungeon-metas">
                <div class="dmeta danger">‚ö†Ô∏è Hohe Niederlagegefahr!</div>
                <div class="dmeta reward">‚≠ê Belohnung: 50 XP</div>
                <div class="dmeta">‚ö° Energie -30</div>
            </div>
        </div>
        <button class="primary-btn" onclick="enterBattle()">BETRETEN</button>
    </div>
    <div class="top-hud">
        <div class="top-hud-bg"></div>
        <div class="top-hud-content">
            <div class="top-avatar"><img id="dungeon-avatar" src="" alt=""></div>
            <div class="top-info">
                <div class="top-name">H√∂llenfestung</div>
                <div class="top-lvl">Boss-Preview</div>
            </div>
            <div class="top-nav">
                <div class="top-nav-btn" onclick="showScreen('home')">üè†</div>
                <div class="top-nav-btn" onclick="showScreen('training')">üèãÔ∏è</div>
                <div class="top-nav-btn" onclick="showScreen('dungeon')">üíÄ</div>
            </div>
        </div>
    </div>
</div>

<!-- ===== BATTLE SCREEN ===== -->
<div id="screen-battle" class="screen">
    <div class="battle-header">‚öîÔ∏è KAMPF ‚öîÔ∏è</div>
    <div class="battle-arena">
        <div class="fighter">
            <img class="fighter-img" id="battle-player" src="" alt="Du">
            <div class="fighter-name">DU</div>
            <div class="hp-box"><div class="hp-bg"><div class="hp-fill" id="hp-player" style="width:100%"></div></div><div class="hp-txt"><span id="hp-player-txt">100</span> HP</div></div>
        </div>
        <div class="vs-badge">VS</div>
        <div class="fighter">
            <img class="fighter-img enemy" id="battle-enemy" src="" alt="Boss">
            <div class="fighter-name">BOSS</div>
            <div class="hp-box"><div class="hp-bg"><div class="hp-fill enemy" id="hp-enemy" style="width:100%"></div></div><div class="hp-txt"><span id="hp-enemy-txt">80</span> HP</div></div>
        </div>
    </div>
    <div class="battle-controls">
        <div class="battle-log" id="battle-log"><p class="log-system">‚öîÔ∏è Der Kampf beginnt!</p></div>
        <div class="battle-btns">
            <button class="battle-btn" onclick="battle('attack')">‚öîÔ∏è<br>ANGRIFF</button>
            <button class="battle-btn" onclick="battle('defend')">üõ°Ô∏è<br>BLOCK</button>
            <button class="battle-btn" onclick="battle('special')">‚ú®<br>SPEZIAL</button>
            <button class="battle-btn" onclick="flee()">üèÉ<br>FLUCHT</button>
        </div>
    </div>
</div>

<div class="toast" id="toast"></div>

</div><!-- #app -->

<script>
const SAVE_KEY = 'bulldog_realm_save';

function saveGame() {
    const data = {
        char: game.char,
        pet: game.pet,
        cds: game.cds,
        savedAt: Date.now()
    };
    localStorage.setItem(SAVE_KEY, JSON.stringify(data));
}

function loadGame() {
    try {
        const raw = localStorage.getItem(SAVE_KEY);
        if (!raw) return false;
        const data = JSON.parse(raw);
        if (!data.char || !data.pet) return false;
        // CD-Werte um vergangene Zeit reduzieren
        const elapsed = Math.floor((Date.now() - data.savedAt) / 1000);
        for (let k in data.cds) {
            data.cds[k] = Math.max(0, (data.cds[k] || 0) - elapsed);
        }
        game.char = data.char;
        game.pet = data.pet;
        game.cds = data.cds;
        return true;
    } catch(e) { return false; }
}

const game = {
    char: null,
    pet: { name:'', lvl:1, xp:0, xpMax:100, hunger:20, happy:60, energy:100, maxHP:100, stats:{atk:10,def:10,spd:10} },
    cds: { feed:0, play:0, sleep:0, atk:0, fit:0, def:0 },
    battle: { active:false, playerHP:100, enemyHP:80, turn:'player' }
};
const chars = {
    demon:  { name:'Shadow',        img:'https://raw.githubusercontent.com/emfau88/bulldog-realm/refs/heads/main/file_0000000009e47243a9b9c69184ce0322.png', stats:{atk:15,def:5,spd:10} },
    angel:  { name:'Fluffi',        img:'https://raw.githubusercontent.com/emfau88/bulldog-realm/refs/heads/main/fluffy2.png', stats:{atk:8,def:7,spd:15} },
    knight: { name:'Sir Barksalot', img:'https://raw.githubusercontent.com/emfau88/bulldog-realm/refs/heads/main/titan2.png', stats:{atk:10,def:15,spd:7} }
};
const CD = { feed:30, play:60, sleep:300, atk:120, fit:90, def:90 };

function selectChar(type, el) {
    document.querySelectorAll('.char-card').forEach(c => c.classList.remove('selected'));
    el.classList.add('selected');
}

function startGame(type) {
    game.char = type;
    const c = chars[type];
    game.pet.name = c.name;
    game.pet.stats = {...c.stats};
    initGame();
    toast(`Willkommen, ${c.name}!`, 'success');
}

function initGame() {
    const c = chars[game.char];
    ['home-avatar','train-avatar','dungeon-avatar'].forEach(id => {
        const el = document.getElementById(id); if (el) el.src = c.img;
    });
    document.getElementById('home-pet').src = c.img;
    document.getElementById('home-name').textContent = game.pet.name;
    const ti = document.getElementById('train-img'); if (ti) ti.src = c.img;
    const tn = document.getElementById('train-name'); if (tn) tn.textContent = game.pet.name;
    showScreen('home');
    updateUI();
    if (!game._started) {
        game._started = true;
        setInterval(() => { tickCD(); saveGame(); }, 1000);
        setInterval(decay, 10000);
    }
}

// Beim Laden: gespeichertes Spiel wiederherstellen
window.addEventListener('DOMContentLoaded', () => {
    if (loadGame()) {
        initGame();
        toast('Spielstand geladen ‚úì', 'success');
    }
});

function showScreen(name) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById('screen-' + name).classList.add('active');
    if (name === 'battle') {
        game.battle.active = true;
        game.battle.playerHP = game.pet.maxHP;
        game.battle.enemyHP = 80;
        game.battle.turn = 'player';
        document.getElementById('battle-player').src = chars[game.char].img;
        document.getElementById('battle-enemy').src = 'https://raw.githubusercontent.com/emfau88/bulldog-realm/refs/heads/main/bosspre.png';
        document.getElementById('battle-log').innerHTML = '';
        updateBattleUI();
        log('‚öîÔ∏è Kampf beginnt!', 'system');
    }
}

function action(type) {
    if (game.cds[type] > 0) { toast(`Warte ${game.cds[type]}s`, 'error'); return; }
    let xp = 0, msg = '', ok = false;
    if (type === 'feed') {
        if (game.pet.hunger <= 0) { toast('Nicht hungrig!', 'error'); return; }
        game.pet.hunger = Math.max(0, game.pet.hunger - 30);
        game.pet.energy = Math.min(100, game.pet.energy + 5);
        xp = 10; msg = 'üçñ Hunger -30'; ok = true;
    } else if (type === 'play') {
        if (game.pet.energy < 15) { toast('Zu m√ºde!', 'error'); return; }
        game.pet.happy = Math.min(100, game.pet.happy + 25);
        game.pet.energy -= 15;
        game.pet.hunger = Math.min(100, game.pet.hunger + 10);
        xp = 15; msg = 'üéæ Gl√ºck +25'; ok = true;
    } else if (type === 'sleep') {
        game.pet.energy = 100;
        game.pet.hunger = Math.min(100, game.pet.hunger + 20);
        game.pet.happy = Math.max(0, game.pet.happy - 10);
        xp = 5; msg = 'üò¥ Energie voll!'; ok = true;
    }
    if (ok) { game.cds[type] = CD[type]; addXP(xp); updateUI(); toast(msg, 'success'); saveGame(); }
}

function trainAction(type) {
    if (game.cds[type] > 0) { toast(`Cooldown: ${game.cds[type]}s`, 'error'); return; }
    if (type === 'atk') {
        if (game.pet.energy < 25) { toast('Brauche 25 Energie!', 'error'); return; }
        game.pet.stats.atk++; game.pet.energy -= 25; game.cds.atk = CD.atk; addXP(25); toast('‚öîÔ∏è ATK +1!', 'success');
    } else if (type === 'fit') {
        if (game.pet.energy < 20) { toast('Brauche 20 Energie!', 'error'); return; }
        game.pet.maxHP += 10; game.pet.energy -= 20; game.cds.fit = CD.fit; addXP(20); toast('üèãÔ∏è HP +10!', 'success');
    } else if (type === 'def') {
        if (game.pet.energy < 20) { toast('Brauche 20 Energie!', 'error'); return; }
        game.pet.stats.def++; game.pet.energy -= 20; game.cds.def = CD.def; addXP(20); toast('üõ°Ô∏è DEF +1!', 'success');
    }
    updateUI(); saveGame();
}

function addXP(n) {
    game.pet.xp += n;
    while (game.pet.xp >= game.pet.xpMax) {
        game.pet.xp -= game.pet.xpMax;
        game.pet.lvl++;
        game.pet.xpMax = Math.floor(game.pet.xpMax * 1.2);
        game.pet.maxHP += 20;
        toast(`üéâ LEVEL ${game.pet.lvl}!`, 'success');
    }
}

function updateUI() {
    const set = (id, v) => { const e = document.getElementById(id); if (e) e.textContent = v; };
    const setW = (id, v) => { const e = document.getElementById(id); if (e) e.style.width = v; };
    const xpPct = Math.floor(game.pet.xp / game.pet.xpMax * 100);
    const sat = Math.max(0, Math.min(100, 100 - game.pet.hunger));

    set('home-lvl', game.pet.lvl); set('home-xp', xpPct);
    setW('bar-hunger', sat + '%'); set('txt-hunger', sat + '%');
    setW('bar-happy', game.pet.happy + '%'); set('txt-happy', game.pet.happy + '%');
    setW('bar-energy', game.pet.energy + '%'); set('txt-energy', game.pet.energy + '%');

    set('train-lvl', game.pet.lvl); set('train-lvl-hud', game.pet.lvl); set('train-xp-pct', xpPct);
    set('train-xp-cur', game.pet.xp); set('train-xp-max', game.pet.xpMax);
    setW('train-xp-bar', xpPct + '%');
    setW('train-energy-bar', game.pet.energy + '%'); set('train-energy-txt', game.pet.energy + '%');
    set('stat-atk', game.pet.stats.atk); set('stat-def', game.pet.stats.def);
    set('stat-hp', Math.floor((game.pet.maxHP - 100) / 10) + 1);

    ['feed','play','sleep'].forEach(act => {
        const btn = document.getElementById('btn-' + act); if (!btn) return;
        const cd = Math.max(0, game.cds[act] || 0);
        btn.classList.toggle('on-cd', cd > 0);
        const txt = btn.querySelector('.cd-txt'); if (txt) txt.textContent = cd > 0 ? cd + 's' : '';
        const bar = btn.querySelector('.cd-bar'); if (bar) bar.style.width = cd > 0 ? (cd/CD[act]*100) + '%' : '0%';
    });

    ['atk','fit','def'].forEach(act => {
        const card = document.getElementById('tcard-' + act);
        const cdEl = document.getElementById('cd-' + act);
        const cd = Math.max(0, game.cds[act] || 0);
        if (card) card.classList.toggle('on-cd', cd > 0);
        if (cdEl) cdEl.textContent = cd > 0 ? '‚è± ' + cd + 's' : '';
    });
}

function tickCD() {
    let changed = false;
    for (let k in game.cds) { if (game.cds[k] > 0) { game.cds[k]--; changed = true; } }
    if (changed) updateUI();
}

function decay() {
    game.pet.hunger = Math.min(100, game.pet.hunger + 5);
    game.pet.happy  = Math.max(0, game.pet.happy - 3);
    game.pet.energy = Math.min(100, game.pet.energy + 2);
    if (game.pet.hunger >= 90) toast('‚ö†Ô∏è Dein Bulldog hat Hunger!', 'error');
    if (game.pet.happy  <= 10) toast('‚ö†Ô∏è Dein Bulldog ist traurig!', 'error');
    updateUI();
}

function enterBattle() {
    if (game.pet.energy < 30) { toast('Zu m√ºde f√ºr Kampf!', 'error'); return; }
    game.pet.energy -= 30; showScreen('battle');
}

function battle(move) {
    if (!game.battle.active || game.battle.turn !== 'player') return;
    if (move === 'attack') {
        const dmg = Math.floor(game.pet.stats.atk * (0.8 + Math.random() * 0.4));
        game.battle.enemyHP -= dmg; log(`‚öîÔ∏è Du verursachst ${dmg} Schaden!`, 'player'); showDmg(dmg, 'enemy');
    } else if (move === 'special' && game.pet.energy >= 30) {
        const dmg = Math.floor(game.pet.stats.atk * 1.5);
        game.battle.enemyHP -= dmg; game.pet.energy -= 30; log(`‚ú® Spezial! ${dmg} Schaden!`, 'player'); showDmg(dmg, 'enemy');
    } else if (move === 'defend') { log('üõ°Ô∏è Du blockst!', 'player'); }
    updateBattleUI();
    if (game.battle.enemyHP <= 0) {
        const xp = 50 + game.pet.lvl * 10; addXP(xp); toast(`SIEG! +${xp} XP`, 'success');
        game.battle.active = false; setTimeout(() => showScreen('home'), 2000); return;
    }
    game.battle.turn = 'enemy'; setTimeout(enemyTurn, 1000);
}

function enemyTurn() {
    const dmg = Math.max(1, Math.floor(12 * (0.8 + Math.random() * 0.4)) - Math.floor(game.pet.stats.def / 5));
    game.battle.playerHP -= dmg; log(`üëπ Boss macht ${dmg} Schaden!`, 'enemy'); showDmg(dmg, 'player');
    updateBattleUI();
    if (game.battle.playerHP <= 0) {
        game.battle.active = false; toast('Niederlage...', 'error'); setTimeout(() => showScreen('home'), 2000);
    } else { game.battle.turn = 'player'; }
}

function updateBattleUI() {
    document.getElementById('hp-player').style.width = (game.battle.playerHP / game.pet.maxHP * 100) + '%';
    document.getElementById('hp-player-txt').textContent = game.battle.playerHP;
    document.getElementById('hp-enemy').style.width = (game.battle.enemyHP / 80 * 100) + '%';
    document.getElementById('hp-enemy-txt').textContent = game.battle.enemyHP;
}

function showDmg(amount, target) {
    const p = document.createElement('div'); p.className = 'dmg-popup'; p.textContent = '-' + amount;
    p.style.left = target === 'player' ? '25%' : '75%'; p.style.top = '40%';
    document.querySelector('.battle-arena').appendChild(p);
    setTimeout(() => p.remove(), 1000);
}

function flee() { game.battle.active = false; showScreen('dungeon'); }

function log(msg, type) {
    const el = document.getElementById('battle-log');
    const p = document.createElement('p'); p.className = 'log-' + type; p.textContent = msg;
    el.appendChild(p); el.scrollTop = el.scrollHeight;
}

function toast(msg, type) {
    const t = document.getElementById('toast');
    t.textContent = msg; t.className = 'toast ' + (type || '');
    setTimeout(() => t.classList.add('show'), 10);
    setTimeout(() => t.classList.remove('show'), 2500);
}
</script>
</body>
</html>
