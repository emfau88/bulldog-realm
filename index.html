<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Bulldog Realms Lite</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #fff;
            overflow-x: hidden;
        }
        
        .screen {
            display: none;
            padding: 20px;
            max-width: 480px;
            margin: 0 auto;
            min-height: 100vh;
        }
        
        .screen.active {
            display: block;
        }
        
        /* SPLASH SCREEN */
        #splash {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .logo {
            font-size: 2.5em;
            font-weight: bold;
            background: linear-gradient(45deg, #ffd700, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: glow 2s ease-in-out infinite;
            margin-bottom: 10px;
        }
        
        @keyframes glow {
            0%, 100% { filter: drop-shadow(0 0 10px rgba(255,215,0,0.5)); }
            50% { filter: drop-shadow(0 0 20px rgba(255,215,0,0.8)); }
        }
        
        .subtitle {
            color: #888;
            font-size: 1.1em;
            margin-bottom: 40px;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            padding: 15px 40px;
            font-size: 1.2em;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(102,126,234,0.4);
            margin: 10px;
        }
        
        .btn:hover, .btn:active {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102,126,234,0.6);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        /* CHARACTER SELECT */
        .select-title {
            text-align: center;
            font-size: 1.8em;
            margin-bottom: 20px;
            color: #ffd700;
        }
        
        .char-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        .char-card {
            background: linear-gradient(135deg, #2d2d44 0%, #1a1a2e 100%);
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 3px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .char-card:hover, .char-card:active {
            transform: scale(1.02);
            border-color: #667eea;
        }
        
        .char-card.selected {
            border-color: #ffd700;
            box-shadow: 0 0 30px rgba(255,215,0,0.3);
        }
        
        .char-sprite {
            width: 100px;
            height: 100px;
            margin: 0 auto 15px;
            border-radius: 50%;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
        }
        
        .shadow-knight .char-sprite {
            background: radial-gradient(circle, #2d2d2d 0%, #000 100%);
            box-shadow: 0 0 30px rgba(139,0,0,0.6), inset 0 0 20px rgba(255,0,0,0.3);
        }
        
        .shadow-knight .char-sprite::after {
            content: "üõ°Ô∏è";
            filter: drop-shadow(0 0 10px #ff0000);
        }
        
        .cotton-candy .char-sprite {
            background: radial-gradient(circle, #ffb6c1 0%, #ff69b4 100%);
            box-shadow: 0 0 30px rgba(255,182,193,0.6);
            animation: sparkle 2s infinite;
        }
        
        @keyframes sparkle {
            0%, 100% { box-shadow: 0 0 30px rgba(255,182,193,0.6); }
            50% { box-shadow: 0 0 50px rgba(255,255,255,0.8), 0 0 30px rgba(255,182,193,0.8); }
        }
        
        .cotton-candy .char-sprite::after {
            content: "üå∏";
        }
        
        .molten-forge .char-sprite {
            background: radial-gradient(circle, #ff4500 0%, #8b0000 100%);
            box-shadow: 0 0 30px rgba(255,69,0,0.6);
            position: relative;
        }
        
        .molten-forge .char-sprite::before {
            content: "";
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 30px;
            background: linear-gradient(to top, #ff4500, transparent);
            border-radius: 50%;
            animation: smoke 1.5s infinite;
        }
        
        @keyframes smoke {
            0% { opacity: 0.8; transform: translateX(-50%) translateY(0); }
            100% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
        }
        
        .molten-forge .char-sprite::after {
            content: "üî•";
        }
        
        .char-name {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .char-desc {
            color: #aaa;
            font-size: 0.9em;
            margin-bottom: 10px;
        }
        
        .char-stats {
            display: flex;
            justify-content: center;
            gap: 15px;
            font-size: 0.85em;
        }
        
        .stat {
            background: rgba(255,255,255,0.1);
            padding: 5px 10px;
            border-radius: 15px;
        }
        
        /* HUB SCREEN */
        .hub-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .hub-pet {
            width: 150px;
            height: 150px;
            margin: 0 auto 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 5em;
            position: relative;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .pet-info {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .pet-name {
            font-size: 1.5em;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 10px;
        }
        
        .pet-level {
            color: #4ecdc4;
            font-size: 1.1em;
            margin-bottom: 15px;
        }
        
        .bars {
            display: grid;
            gap: 10px;
        }
        
        .bar {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .bar-label {
            width: 60px;
            font-size: 0.9em;
        }
        
        .bar-track {
            flex: 1;
            height: 20px;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .bar-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s;
        }
        
        .hp-fill { background: linear-gradient(90deg, #ff6b6b, #ee5a5a); }
        .hunger-fill { background: linear-gradient(90deg, #f9ca24, #f0932b); }
        .energy-fill { background: linear-gradient(90deg, #74b9ff, #0984e3); }
        .xp-fill { background: linear-gradient(90deg, #a29bfe, #6c5ce7); }
        
        .hub-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .action-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            padding: 20px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1em;
        }
        
        .action-btn:hover, .action-btn:active {
            transform: scale(1.05);
        }
        
        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .action-icon {
            font-size: 2em;
            display: block;
            margin-bottom: 5px;
        }
        
        .inventory {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 15px;
        }
        
        .inv-title {
            font-size: 1.2em;
            margin-bottom: 10px;
            color: #ffd700;
        }
        
        .inv-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }
        
        .inv-slot {
            aspect-ratio: 1;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            border: 2px solid transparent;
            cursor: pointer;
        }
        
        .inv-slot.equipped {
            border-color: #ffd700;
            box-shadow: 0 0 10px rgba(255,215,0,0.3);
        }
        
        .inv-slot.common { border-color: #888; }
        .inv-slot.rare { border-color: #74b9ff; }
        .inv-slot.epic { border-color: #a29bfe; }
        
        /* DUNGEON SCREEN */
        .dungeon-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .dungeon-title {
            font-size: 1.8em;
            color: #ff6b6b;
            margin-bottom: 10px;
        }
        
        .dungeon-level {
            color: #888;
        }
        
        .combat-arena {
            background: linear-gradient(180deg, #2d5016 0%, #1a3009 100%);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            min-height: 200px;
            position: relative;
        }
        
        .combatants {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .combat-pet, .combat-enemy {
            text-align: center;
        }
        
        .combat-sprite {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            margin-bottom: 10px;
        }
        
        .combat-pet .combat-sprite {
            background: radial-gradient(circle, #667eea 0%, #764ba2 100%);
        }
        
        .combat-enemy .combat-sprite {
            background: radial-gradient(circle, #2d2d2d 0%, #000 100%);
            animation: enemy-idle 1s infinite;
        }
        
        @keyframes enemy-idle {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(5px); }
        }
        
        .combat-bar {
            width: 60px;
            height: 8px;
            background: rgba(0,0,0,0.5);
            border-radius: 4px;
            margin: 5px auto;
            overflow: hidden;
        }
        
        .combat-hp {
            height: 100%;
            background: #ff6b6b;
            border-radius: 4px;
            transition: width 0.3s;
        }
        
        .combat-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .combat-btn {
            padding: 15px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
        }
        
        .combat-btn.attack {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a5a 100%);
            color: white;
        }
        
        .combat-btn.skill {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
        }
        
        .combat-btn.heal {
            background: linear-gradient(135deg, #55efc4 0%, #00b894 100%);
            color: white;
        }
        
        .combat-btn.flee {
            background: linear-gradient(135deg, #b2bec3 0%, #636e72 100%);
            color: white;
        }
        
        .combat-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .combat-log {
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            max-height: 150px;
            overflow-y: auto;
            font-size: 0.9em;
        }
        
        .log-entry {
            margin-bottom: 5px;
            padding: 5px;
            border-radius: 5px;
        }
        
        .log-entry.damage {
            background: rgba(255,107,107,0.2);
        }
        
        .log-entry.heal {
            background: rgba(85,239,196,0.2);
        }
        
        .log-entry.loot {
            background: rgba(255,215,0,0.2);
        }
        
        /* VICTORY MODAL */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: linear-gradient(135deg, #2d2d44 0%, #1a1a2e 100%);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            max-width: 350px;
            animation: modal-pop 0.3s;
        }
        
        @keyframes modal-pop {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .modal-title {
            font-size: 2em;
            margin-bottom: 15px;
        }
        
        .modal-title.victory {
            color: #ffd700;
        }
        
        .modal-title.defeat {
            color: #ff6b6b;
        }
        
        .loot-display {
            margin: 20px 0;
        }
        
        .loot-item {
            font-size: 3em;
            margin: 10px;
            animation: loot-bounce 0.5s infinite alternate;
        }
        
        @keyframes loot-bounce {
            from { transform: translateY(0); }
            to { transform: translateY(-10px); }
        }
        
        /* RESPONSIVE */
        @media (max-width: 400px) {
            .logo { font-size: 2em; }
            .hub-actions { grid-template-columns: 1fr; }
            .combat-actions { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- SPLASH SCREEN -->
    <div id="splash" class="screen active">
        <div class="logo">üê∂ BULLDOG REALMS</div>
        <div class="subtitle">Lite Edition</div>
        <button class="btn" onclick="showScreen('char-select')">Neues Spiel</button>
        <button class="btn btn-secondary" onclick="loadGame()">Spiel Laden</button>
    </div>
    
    <!-- CHARACTER SELECT -->
    <div id="char-select" class="screen">
        <div class="select-title">W√§hle deinen Bulldog</div>
        <div class="char-grid">
            <div class="char-card shadow-knight" onclick="selectChar('shadow')">
                <div class="char-sprite"></div>
                <div class="char-name">Shadow Knight</div>
                <div class="char-desc">Unersch√ºtterlicher Tank mit dunkler Macht</div>
                <div class="char-stats">
                    <span class="stat">‚ù§Ô∏è HP: Hoch</span>
                    <span class="stat">‚öîÔ∏è ATK: Mittel</span>
                </div>
            </div>
            <div class="char-card cotton-candy" onclick="selectChar('cotton')">
                <div class="char-sprite"></div>
                <div class="char-name">Cotton Candy</div>
                <div class="char-desc">Gl√ºckbringende Magierin mit Zucker-Rush</div>
                <div class="char-stats">
                    <span class="stat">üçÄ LUCK: Hoch</span>
                    <span class="stat">‚ö° AGI: Hoch</span>
                </div>
            </div>
            <div class="char-card molten-forge" onclick="selectChar('molten')">
                <div class="char-sprite"></div>
                <div class="char-name">Molten Forge</div>
                <div class="char-desc">Feuriger Krieger mit zerst√∂rerischer Kraft</div>
                <div class="char-stats">
                    <span class="stat">‚öîÔ∏è ATK: Hoch</span>
                    <span class="stat">‚ù§Ô∏è HP: Mittel</span>
                </div>
            </div>
        </div>
        <button class="btn" id="start-btn" onclick="startGame()" style="width: 100%; margin-top: 20px; display: none;">Abenteuer starten!</button>
    </div>
    
    <!-- HUB SCREEN -->
    <div id="hub" class="screen">
        <div class="hub-header">
            <div class="hub-pet" id="hub-pet-sprite"></div>
        </div>
        
        <div class="pet-info">
            <div class="pet-name" id="pet-name">Name</div>
            <div class="pet-level">Level <span id="pet-level">1</span> | XP: <span id="pet-xp">0</span>/<span id="pet-max-xp">100</span></div>
            <div class="bars">
                <div class="bar">
                    <span class="bar-label">‚ù§Ô∏è HP</span>
                    <div class="bar-track"><div class="bar-fill hp-fill" id="hp-bar" style="width: 100%"></div></div>
                    <span id="hp-text">100/100</span>
                </div>
                <div class="bar">
                    <span class="bar-label">üçñ Hunger</span>
                    <div class="bar-track"><div class="bar-fill hunger-fill" id="hunger-bar" style="width: 100%"></div></div>
                    <span id="hunger-text">100/100</span>
                </div>
                <div class="bar">
                    <span class="bar-label">‚ö° Energie</span>
                    <div class="bar-track"><div class="bar-fill energy-fill" id="energy-bar" style="width: 100%"></div></div>
                    <span id="energy-text">100/100</span>
                </div>
                <div class="bar">
                    <span class="bar-label">‚≠ê XP</span>
                    <div class="bar-track"><div class="bar-fill xp-fill" id="xp-bar" style="width: 0%"></div></div>
                </div>
            </div>
        </div>
        
        <div class="hub-actions">
            <button class="action-btn" onclick="feedPet()">
                <span class="action-icon">üçñ</span>
                F√ºttern
            </button>
            <button class="action-btn" onclick="playWithPet()">
                <span class="action-icon">üéæ</span>
                Spielen
            </button>
            <button class="action-btn" onclick="restPet()">
                <span class="action-icon">üò¥</span>
                Schlafen
            </button>
            <button class="action-btn" onclick="trainPet()">
                <span class="action-icon">üí™</span>
                Training
            </button>
        </div>
        
        <button class="btn" onclick="goDungeon()" style="width: 100%; margin-bottom: 20px;">
            üó°Ô∏è Dungeon betreten
        </button>
        
        <div class="inventory">
            <div class="inv-title">üéí Inventar</div>
            <div class="inv-grid" id="inventory-grid">
                <!-- Slots generated by JS -->
            </div>
        </div>
        
        <button class="btn btn-secondary" onclick="saveGame()" style="width: 100%; margin-top: 20px;">
            üíæ Speichern
        </button>
    </div>
    
    <!-- DUNGEON SCREEN -->
    <div id="dungeon" class="screen">
        <div class="dungeon-header">
            <div class="dungeon-title">üå≤ Wald-Dungeon</div>
            <div class="dungeon-level">Level <span id="dungeon-lvl">1</span>/5</div>
        </div>
        
        <div class="combat-arena">
            <div class="combatants">
                <div class="combat-pet">
                    <div class="combat-sprite" id="combat-pet-icon">üê∂</div>
                    <div class="combat-bar"><div class="combat-hp" id="combat-pet-hp" style="width: 100%"></div></div>
                    <div id="combat-pet-name">Du</div>
                </div>
                <div style="font-size: 2em;">‚öîÔ∏è</div>
                <div class="combat-enemy">
                    <div class="combat-sprite" id="combat-enemy-icon">üëπ</div>
                    <div class="combat-bar"><div class="combat-hp" id="combat-enemy-hp" style="width: 100%"></div></div>
                    <div id="combat-enemy-name">Goblin</div>
                </div>
            </div>
        </div>
        
        <div class="combat-actions">
            <button class="combat-btn attack" onclick="combatAction('attack')" id="btn-attack">
                ‚öîÔ∏è Angriff
            </button>
            <button class="combat-btn skill" onclick="combatAction('skill')" id="btn-skill">
                ‚ú® F√§higkeit
            </button>
            <button class="combat-btn heal" onclick="combatAction('heal')" id="btn-heal">
                üß™ Heilen
            </button>
            <button class="combat-btn flee" onclick="combatAction('flee')" id="btn-flee">
                üèÉ Flucht
            </button>
        </div>
        
        <div class="combat-log" id="combat-log"></div>
        
        <button class="btn btn-secondary" onclick="leaveDungeon()" style="width: 100%; margin-top: 15px;">
            üè† Zur√ºck zum Hub
        </button>
    </div>
    
    <!-- VICTORY/DEFEAT MODAL -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-title" id="modal-title">Sieg!</div>
            <div id="modal-text">Du hast gewonnen!</div>
            <div class="loot-display" id="loot-display"></div>
            <button class="btn" onclick="closeModal()" style="width: 100%;">Weiter</button>
        </div>
    </div>
    
    <script>
        // GAME DATA
        const CHARACTERS = {
            shadow: { name: 'Shadow Knight', icon: 'üõ°Ô∏è', hp: 120, atk: 15, def: 10, luck: 5, color: 'shadow-knight' },
            cotton: { name: 'Cotton Candy', icon: 'üå∏', hp: 80, atk: 12, def: 5, luck: 15, color: 'cotton-candy' },
            molten: { name: 'Molten Forge', icon: 'üî•', hp: 100, atk: 20, def: 7, luck: 5, color: 'molten-forge' }
        };
        
        const ENEMIES = [
            { name: 'Goblin', icon: 'üë∫', hp: 30, atk: 8, xp: 20 },
            { name: 'Wolf', icon: 'üê∫', hp: 45, atk: 12, xp: 35 },
            { name: 'Orc', icon: 'üëπ', hp: 60, atk: 15, xp: 50 },
            { name: 'Troll', icon: 'üßü', hp: 80, atk: 18, xp: 70 },
            { name: 'Baumw√§chter', icon: 'üå≥', hp: 120, atk: 25, xp: 150 }
        ];
        
        const LOOT_TABLE = [
            { icon: 'üó°Ô∏è', name: 'Rostiges Schwert', type: 'weapon', rarity: 'common', atk: 2 },
            { icon: 'üõ°Ô∏è', name: 'Holzschild', type: 'armor', rarity: 'common', def: 2 },
            { icon: '‚öîÔ∏è', name: 'Stahlklinge', type: 'weapon', rarity: 'rare', atk: 5 },
            { icon: 'üß•', name: 'Lederweste', type: 'armor', rarity: 'rare', def: 4 },
            { icon: 'üíç', name: 'Gl√ºcksring', type: 'accessory', rarity: 'epic', luck: 5 },
            { icon: 'üçñ', name: 'Fleischration', type: 'consumable', heal: 30 },
            { icon: 'üß™', name: 'Heiltrank', type: 'consumable', heal: 50 }
        ];
        
        // GAME STATE
        let game = {
            charType: null,
            pet: null,
            inventory: [],
            equipped: { weapon: null, armor: null, accessory: null },
            dungeonLevel: 1,
            inCombat: false,
            currentEnemy: null
        };
        
        let selectedChar = null;
        
        // SCREEN MANAGEMENT
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }
        
        // CHARACTER SELECTION
        function selectChar(type) {
            selectedChar = type;
            document.querySelectorAll('.char-card').forEach(c => c.classList.remove('selected'));
            document.querySelector(`.char-card.${CHARACTERS[type].color}`).classList.add('selected');
            document.getElementById('start-btn').style.display = 'block';
        }
        
        function startGame() {
            const char = CHARACTERS[selectedChar];
            game.charType = selectedChar;
            game.pet = {
                name: char.name,
                level: 1,
                xp: 0,
                maxXp: 100,
                hp: char.hp,
                maxHp: char.hp,
                hunger: 100,
                energy: 100,
                atk: char.atk,
                def: char.def,
                luck: char.luck,
                baseStats: { hp: char.hp, atk: char.atk, def: char.def, luck: char.luck }
            };
            game.inventory = [];
            game.dungeonLevel = 1;
            
            updateHub();
            showScreen('hub');
        }
        
        // HUB FUNCTIONS
        function updateHub() {
            const pet = game.pet;
            const char = CHARACTERS[game.charType];
            
            document.getElementById('hub-pet-sprite').className = `hub-pet ${char.color}`;
            document.getElementById('hub-pet-sprite').innerHTML = char.icon;
            
            document.getElementById('pet-name').textContent = pet.name;
            document.getElementById('pet-level').textContent = pet.level;
            document.getElementById('pet-xp').textContent = pet.xp;
            document.getElementById('pet-max-xp').textContent = pet.maxXp;
            
            document.getElementById('hp-bar').style.width = `${(pet.hp / pet.maxHp) * 100}%`;
            document.getElementById('hunger-bar').style.width = `${pet.hunger}%`;
            document.getElementById('energy-bar').style.width = `${pet.energy}%`;
            document.getElementById('xp-bar').style.width = `${(pet.xp / pet.maxXp) * 100}%`;
            
            document.getElementById('hp-text').textContent = `${Math.floor(pet.hp)}/${pet.maxHp}`;
            document.getElementById('hunger-text').textContent = `${Math.floor(pet.hunger)}/100`;
            document.getElementById('energy-text').textContent = `${Math.floor(pet.energy)}/100`;
            
            updateInventory();
        }
        
        function updateInventory() {
            const grid = document.getElementById('inventory-grid');
            grid.innerHTML = '';
            
            for (let i = 0; i < 12; i++) {
                const slot = document.createElement('div');
                slot.className = 'inv-slot';
                
                if (game.inventory[i]) {
                    const item = game.inventory[i];
                    slot.textContent = item.icon;
                    slot.classList.add(item.rarity || 'common');
                    slot.title = item.name;
                    slot.onclick = () => useItem(i);
                }
                
                grid.appendChild(slot);
            }
        }
        
        function feedPet() {
            if (game.pet.hunger >= 100) {
                alert('Dein Bulldog ist satt!');
                return;
            }
            game.pet.hunger = Math.min(100, game.pet.hunger + 30);
            game.pet.hp = Math.min(game.pet.maxHp, game.pet.hp + 10);
            updateHub();
        }
        
        function playWithPet() {
            if (game.pet.energy < 10) {
                alert('Zu m√ºde zum Spielen!');
                return;
            }
            game.pet.energy -= 10;
            game.pet.xp += 5;
            checkLevelUp();
            updateHub();
        }
        
        function restPet() {
            game.pet.energy = Math.min(100, game.pet.energy + 50);
            game.pet.hp = Math.min(game.pet.maxHp, game.pet.hp + 20);
            game.pet.hunger -= 10;
            updateHub();
        }
        
        function trainPet() {
            if (game.pet.energy < 20) {
                alert('Nicht genug Energie!');
                return;
            }
            game.pet.energy -= 20;
            game.pet.xp += 15;
            checkLevelUp();
            updateHub();
        }
        
        function checkLevelUp() {
            while (game.pet.xp >= game.pet.maxXp) {
                game.pet.xp -= game.pet.maxXp;
                game.pet.level++;
                game.pet.maxXp = Math.floor(game.pet.maxXp * 1.5);
                
                // Stat boosts
                game.pet.maxHp += 10;
                game.pet.hp = game.pet.maxHp;
                game.pet.atk += 2;
                game.pet.def += 1;
                
                alert(`üéâ Level Up! ${game.pet.name} ist jetzt Level ${game.pet.level}!`);
            }
        }
        
        // DUNGEON FUNCTIONS
        function goDungeon() {
            if (game.pet.energy < 30) {
                alert('Nicht genug Energie f√ºr den Dungeon! (min. 30)');
                return;
            }
            if (game.pet.hunger < 20) {
                alert('Dein Bulldog ist zu hungrig!');
                return;
            }
            
            game.pet.energy -= 30;
            game.pet.hunger -= 20;
            startCombat();
            showScreen('dungeon');
        }
        
        function startCombat() {
            const enemyTemplate = ENEMIES[game.dungeonLevel - 1];
            game.currentEnemy = {
                ...enemyTemplate,
                maxHp: enemyTemplate.hp
            };
            game.inCombat = true;
            
            document.getElementById('dungeon-lvl').textContent = game.dungeonLevel;
            document.getElementById('combat-enemy-icon').textContent = game.currentEnemy.icon;
            document.getElementById('combat-enemy-name').textContent = game.currentEnemy.name;
            document.getElementById('combat-pet-icon').textContent = CHARACTERS[game.charType].icon;
            document.getElementById('combat-pet-name').textContent = game.pet.name;
            
            updateCombatBars();
            document.getElementById('combat-log').innerHTML = '';
            addLog(`Ein wilder ${game.currentEnemy.name} erscheint!`, 'damage');
            
            setCombatButtons(true);
        }
        
        function updateCombatBars() {
            document.getElementById('combat-pet-hp').style.width = `${(game.pet.hp / game.pet.maxHp) * 100}%`;
            document.getElementById('combat-enemy-hp').style.width = `${(game.currentEnemy.hp / game.currentEnemy.maxHp) * 100}%`;
        }
        
        function setCombatButtons(enabled) {
            ['btn-attack', 'btn-skill', 'btn-heal', 'btn-flee'].forEach(id => {
                document.getElementById(id).disabled = !enabled;
            });
        }
        
        function combatAction(action) {
            if (!game.inCombat) return;
            
            setCombatButtons(false);
            
            let playerDamage = 0;
            let enemyDamage = 0;
            
            switch(action) {
                case 'attack':
                    playerDamage = Math.floor(game.pet.atk * (0.8 + Math.random() * 0.4));
                    addLog(`Du greifst an f√ºr ${playerDamage} Schaden!`, 'damage');
                    break;
                case 'skill':
                    playerDamage = Math.floor(game.pet.atk * 1.5);
                    addLog(`F√§higkeit! ${playerDamage} Schaden!`, 'damage');
                    break;
                case 'heal':
                    const heal = 30;
                    game.pet.hp = Math.min(game.pet.maxHp, game.pet.hp + heal);
                    addLog(`Du heilst dich um ${heal} HP!`, 'heal');
                    break;
                case 'flee':
                    if (Math.random() > 0.5) {
                        addLog('Flucht erfolgreich!', 'heal');
                        setTimeout(() => {
                            showScreen('hub');
                            updateHub();
                        }, 1000);
                        return;
                    } else {
                        addLog('Flucht fehlgeschlagen!', 'damage');
                    }
                    break;
            }
            
            game.currentEnemy.hp -= playerDamage;
            updateCombatBars();
            
            if (game.currentEnemy.hp <= 0) {
                victory();
                return;
            }
            
            // Enemy turn
            setTimeout(() => {
                enemyDamage = Math.max(1, Math.floor(game.currentEnemy.atk * (0.8 + Math.random() * 0.4) - game.pet.def * 0.3));
                game.pet.hp -= enemyDamage;
                addLog(`${game.currentEnemy.name} greift an f√ºr ${enemyDamage} Schaden!`, 'damage');
                updateCombatBars();
                
                if (game.pet.hp <= 0) {
                    defeat();
                } else {
                    setCombatButtons(true);
                }
            }, 800);
        }
        
        function addLog(text, type) {
            const log = document.getElementById('combat-log');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = text;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }
        
        function victory() {
            game.inCombat = false;
            const xpGain = game.currentEnemy.xp;
            game.pet.xp += xpGain;
            
            // Generate loot
            const loot = generateLoot();
            if (loot) {
                game.inventory.push(loot);
            }
            
            checkLevelUp();
            
            document.getElementById('modal-title').textContent = 'üéâ Sieg!';
            document.getElementById('modal-title').className = 'modal-title victory';
            document.getElementById('modal-text').innerHTML = `Du hast ${game.currentEnemy.name} besiegt!<br>+${xpGain} XP`;
            
            const lootDisplay = document.getElementById('loot-display');
            if (loot) {
                lootDisplay.innerHTML = `<div class="loot-item">${loot.icon}</div><div>${loot.name}</div>`;
            } else {
                lootDisplay.innerHTML = '<div style="color: #888;">Kein Loot diesmal...</div>';
            }
            
            document.getElementById('modal').classList.add('active');
            
            if (game.dungeonLevel < 5) {
                game.dungeonLevel++;
            }
        }
        
        function defeat() {
            game.inCombat = false;
            game.pet.hp = 1;
            
            document.getElementById('modal-title').textContent = 'üíÄ Niederlage...';
            document.getElementById('modal-title').className = 'modal-title defeat';
            document.getElementById('modal-text').textContent = 'Du wurdest besiegt! Ruh dich aus und versuch es erneut.';
            document.getElementById('loot-display').innerHTML = '';
            
            document.getElementById('modal').classList.add('active');
        }
        
        function generateLoot() {
            if (Math.random() > 0.6) return null;
            
            const luckBonus = game.pet.luck * 0.02;
            let rarity = 'common';
            const roll = Math.random() - luckBonus;
            
            if (roll < 0.1) rarity = 'epic';
            else if (roll < 0.3) rarity = 'rare';
            
            const possibleLoot = LOOT_TABLE.filter(item => item.rarity === rarity || (rarity === 'common' && !item.rarity));
            return possibleLoot[Math.floor(Math.random() * possibleLoot.length)];
        }
        
        function useItem(index) {
            const item = game.inventory[index];
            if (!item) return;
            
            if (item.type === 'consumable') {
                game.pet.hp = Math.min(game.pet.maxHp, game.pet.hp + item.heal);
                game.inventory.splice(index, 1);
                updateHub();
            } else {
                alert(`${item.name}: ${item.atk ? 'Angriff +' + item.atk : item.def ? 'Verteidigung +' + item.def : 'Gl√ºck +' + item.luck}`);
            }
        }
        
        function closeModal() {
            document.getElementById('modal').classList.remove('active');
            showScreen('hub');
            updateHub();
        }
        
        function leaveDungeon() {
            if (game.inCombat) {
                if (!confirm('Wirklich fliehen? Der Kampf wird abgebrochen!')) return;
                game.inCombat = false;
            }
            showScreen('hub');
            updateHub();
        }
        
        // SAVE/LOAD
        function saveGame() {
            localStorage.setItem('bulldogRealmsSave', JSON.stringify(game));
            alert('üíæ Spiel gespeichert!');
        }
        
        function loadGame() {
            const save = localStorage.getItem('bulldogRealmsSave');
            if (!save) {
                alert('Kein Spielstand gefunden!');
                return;
            }
            
            game = JSON.parse(save);
            updateHub();
            showScreen('hub');
        }
        
        // Auto-save on page unload
        window.addEventListener('beforeunload', () => {
            if (game.pet) {
                localStorage.setItem('bulldogRealmsSave', JSON.stringify(game));
            }
        });
    </script>
</body>
</html>
